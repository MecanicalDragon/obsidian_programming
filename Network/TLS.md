**SSL** is the direct predecessor of **TLS** (Transport Layer Security). The differences between the final version of SSL (3.0) in 1999 and the first version of TLS are faint; the name change was applied to signify the change in ownership. The RSA key exchange algorithm, used in SSL and versions of TLS before 1.3, is considered not secure nowadays. The *TLS handshake* roughly goes as follows:

1. **The 'client hello' message**: The client initiates the handshake by sending a "hello" message to the server. The message includes which TLS version client supports, supported cipher suites, and a string of random bytes - "*client random*".
2. **The 'server hello' message**: In reply to the client hello message, the server sends a message containing the server's SSL certificate, chosen cipher suite, and the "*server random*" - another random byte string, generated by the server.
3. **Authentication**: The client verifies the server's SSL certificate with the certificate authority that issued it. This confirms that the server is who it says it is, and that the client is interacting with the actual owner of the domain.
4. **The premaster secret**: The client gets the public key from the server's SSL certificate and sends one more random string of bytes, the "*premaster secret*". The premaster secret is encrypted with the public key and can only be decrypted with the private key by the server. The client sends a "finished" message that is encrypted with a session key.
5. **Private key used**: The server decrypts the premaster secret.  Both client and server generate session keys from the *client random*, the *server random*, and the *premaster secret*. They should arrive at the same results.
6. **Server is ready**: The server sends a "finished" message encrypted with a session key.
7. **Secure symmetric encryption achieved**: handshake is completed, and communication continues using the session keys.

All these 4 interactions take approximately *110 ms*.

**TLS 1.3** does not support RSA or any other cipher suites and parameters that are vulnerable to attack. It also shortens the TLS handshake, making a TLS 1.3 handshake both faster and more secure. The basic steps of a TLS 1.3 handshake are:

1. **Client hello**: The client sends a client hello message with the protocol version, the client random, and a list of cipher suites. The client hello also includes the [[#Parameters]] that will be used to calculate the premaster secret. Essentially, the client is assuming that it knows the server’s preferred key exchange method, and this cuts down the overall length of the handshake.
2. **Server generates master secret**: At this point, the server has received the client random and the client's parameters and cipher suites. It already has the server random since it can generate that on its own. Therefore, the server can create the master secret.
3. **Server hello and "Finished"**: The server hello includes the server’s certificate, digital signature, server random, and chosen cipher suite. Also, the server sends its own [[#Parameters]] to establish a secure connection. Since it already has the master secret, it also sends a "Finished" message.
4. **Client "Finished"**: Client verifies signature and certificate, generates master secret, and sends "Finished" message.
5. **Secure symmetric encryption achieved**: handshake is completed, and communication continues using the session keys.

TLS 1.3 also supports an even faster version of the TLS handshake that is called *0-RTT mode*. It does not require any round trips, or back-and-forth communication between client and server, at all. If the client and the server have connected to each other before (as in, if the user has visited the website before), they can each derive another shared secret from the first session, called the "*resumption main secret*". The server also sends the client something called a *session ticket* during this first session. The client can use this shared secret to send encrypted data to the server on its first message of the next session, along with that session ticket, and TLS connection resumes between client and server.

[source](https://www.cloudflare.com/learning/ssl/what-happens-in-a-tls-handshake/)
### Parameters
What are these parameters? *Diffie-Hellman algorithm* is used to establish a secure connection, and these parameters are data for this algorithm. How does it work? Each side performs the following actions:

- generate a random natural number `a` - a closed key.
- in collaboration with remote site determine open parameters `p` and `g` (usually these parameters are generated on one site and conveyed to another one), where:
	- `p` and `(p-1)/2` are random prime numbers
	- `g` is a *primitive root modulo p* (`p`) and a prime number too
- calculate open key `A`: `A = ga mod p`
- exchange open keys with remote site
- compute common secret key `K` using the open key of remote site `B` and its own closed key `a`: `K = Ba mod p`. 

`К` is equal on both sides, because `Ba mod p = (gb mod p)a mod p = gab mod p = (ga mod p)b mod p = Ab mod p`. Both sites can use `K` as a secret key, because for malefactor compute `K` with intercepted data is impossible for acceptable time if numbers `p`, `a`, `b` are big enough. Number `g` is not necessary to be big and usually has value within 10.
