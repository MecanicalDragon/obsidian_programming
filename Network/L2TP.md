**L2TP** (Layer 2 Tunneling Protocol) — туннельный протокол 5 уровня, был придуман как универсальный способ провести [[PPP]] через любую сеть (не только IP, хотя на практике это почти не пригодилось, потому что IP всех победил). Его главная задача - взять _PPP-кадры_ (как если бы клиент звонил по модему) и передать их по сети, чтобы можно было использовать привычные механизмы PPP (аутентификация, выделение клиенту IP-адреса, учёт времени (билинг)) в любой сети.

В сетях IP L2TP устанавливает [[Tunneling|туннель]] (L2TP Control Connection) через зарезервированный [[TCP & UDP#^UDP|UDP]]-порт `1701`, и в рамках этого туннеля поднимает множественные сессии, каждая из которых соответствует отдельному PPP-потоку.

В L2TP есть два уровня идентификаторов, передающиеся в заголовках:
- _Tunnel ID_ — идентификатор канала управления между *LAC* и *LNS*.
- _Session ID_ — идентификатор конкретной PPP-сессии внутри этого туннеля.

**LAC (L2TP Access Concentrator)** — это устройство на стороне провайдера, которое принимает *PPP* подключение от клиента (например, по *DSL* или *Ethernet*) и инкапсулирует его в L2TP-туннель.

**LNS (L2TP Network Server)** — это устройство в ядре сети (или в корпоративной сети), которое завершает туннель, распаковывает _PPP_ и обрабатывает его как будто клиент подключён напрямую.

**Причины существования нескольких туннелей**
- **Разные пары LAC ↔ LNS**. У провайдера может быть несколько LNS (разные площадки или разные сервисы). LAC поднимает отдельный туннель к каждому из них.
- **Изоляция**. Туннель имеет свои атрибуты: назначение, настройки *QoS* (quality of service), биллинг - если нужны разные политики, проще создать отдельные туннели, чем мешать всё в один.
- **Масштабируемость и отказоустойчивость**. У LAC могут быть тысячи абонентов. Разделение их сессий по разным туннелям позволяет распределять нагрузку. Если один туннель «упадёт», другие продолжают работать.

**Причины существования множества сессий**
- через один L2TP-туннель можно провести несколько PPP-сессий (например, если у одного клиента несколько логических подключений — разные VPN-профили, разные сервисы, или даже это вообще разные клиенты, обращающиеся к одному LAC).
- оптимизация ресурсов: чтобы не плодить десятки отдельных UDP-туннелей между теми же точками, можно держать один канал управления и в нём множество сессий.

Сейчас L2TP устарел и используется только в качестве легаси в корпоративных VPN сетях в комбинации в *IPsec* - таким же легаси набором протоколов для защиты IP-трафика на сетевом уровне (L3).
