В наши дни программное обеспечение обычно распространяется в виде сервисов, называемых *веб-приложения* (web-apps) или *software-as-a-service* (SaaS). Приложение 12 факторов — это методология для создания приложений, которые:
- Используют декларативный формат для описания процесса установки и настройки, что сводит к минимуму затраты времени и ресурсов для новых разработчиков, подключённых к проекту;
- Имеют соглашение с операционной системой, предполагающее максимальную переносимость между средами выполнения;
- Подходят для развёртывания на современных облачных платформах, устраняя необходимость в серверах и системном администрировании;
- Сводят к минимуму расхождения между средой разработки и средой выполнения, что позволяет использовать непрерывное развёртывание (*continuous deployment*) для максимальной гибкости;
- И могут масштабироваться без существенных изменений в инструментах, архитектуре и практике разработки.

Source: [https://12factor.net/ru/](https://12factor.net/ru/)

# Двенадцать факторов

## I. Кодовая база.

**Одна кодовая база, отслеживаемая в системе контроля версий, – множество развёртываний.** 

Всегда есть однозначное соответствие между кодовой базой и приложением:

- Если есть несколько кодовых баз, то это не приложение — это распределённая система. Каждый компонент в распределённой системе является приложением и каждый компонент может индивидуально соответствовать двенадцати факторам.
- Факт того, что несколько приложений совместно используют тот же самый код, является нарушением двенадцати факторов. Решением в данной ситуации является выделение общего кода в библиотеки, которые могут быть подключены через [менеджер зависимостей](https://12factor.net/ru/dependencies).

## II. Зависимости.

**Явно объявляйте и изолируйте зависимости.**

Приложение двенадцати факторов никогда не зависит от неявно существующих, доступных всей системе пакетов. Приложение объявляет все свои зависимости полностью и точно с помощью манифеста декларации зависимостей. Кроме того, оно использует инструмент изоляции зависимостей во время выполнения для обеспечения того, что неявные зависимости не “просочились” из окружающей системы. Полная и явная спецификация зависимостей применяется равным образом как при разработке, так и при работе приложения.

## III. Конфигурация.

**Сохраняйте конфигурацию в среде выполнения.**

Приложение двенадцати факторов хранит конфигурацию в переменных окружения и требует строгого разделения конфигурации и кода. Переменные окружения легко изменить между развёртываниями, не изменяя код.

## IV. Сторонние службы.

**Считайте сторонние службы (backing services) подключаемыми ресурсами.**

Код приложения двенадцати факторов не делает различий между локальными и сторонними сервисами. Для приложения каждый из них является подключаемым ресурсом, доступным по URL-адресу или по другой паре расположение/учётные данные, хранящимися в конфигурации. Каждое развёртывание приложения двенадцати факторов должно иметь возможность заменить локальную базу данных на любую управляемую третьей стороной без каких-либо изменений кода приложения. Аналогичным образом, локальный SMTP сервер может быть заменён сторонним без изменения кода. В обоих случаях необходимо изменить только идентификатор ресурса в конфигурации.

## V. Сборка, релиз, выполнение.

**Строго разделяйте стадии сборки и выполнения.**

Приложение двенадцати факторов использует строгое разделение между этапами сборки, релиза и выполнения. [Кодовая база](https://12factor.net/ru/codebase) трансформируется в развёртывание (не учитывая развёртывание для разработки) за три этапа:

- Этап сборки – это трансформация, которая преобразует репозиторий кода в исполняемый пакет, называемый сборка. Используя версию кода по указанному процессом развёртывания коммиту, этап сборки загружает сторонние зависимости и компилирует двоичные файлы и ресурсы (assets).
- Этап релиза принимает сборку и объединяет её с текущей конфигурацией развёртывания. Полученный релиз содержит сборку и конфигурацию, и готов к немедленному запуску в среде выполнения.
- Этап выполнения (Runtime) запускает приложение в среде выполнения путём запуска некоторого набора процессов приложения из определённого релиза.

## VI. Процессы.

**Запускайте приложение как процессы, не сохраняющие внутреннее состояние (stateless).**

Приложение выполняется в среде выполнения как один или несколько процессов. Процессы приложения двенадцати факторов не сохраняют внутреннее состояние (stateless) и не имеют разделяемых данных ([share-nothing](https://en.wikipedia.org/wiki/Shared-nothing_architecture)). Любые данные, которые требуется сохранить, должны быть сохранены в хранящей состояние сторонней службе, обычно, в базе данных.

## VII. Привязка портов.

**Экспортируйте сервисы через привязку портов.**

Приложение двенадцати факторов является полностью самодостаточным и не полагается на инъекцию веб-сервера во время выполнения для того, чтобы создать веб-сервис. Веб-приложение экспортирует HTTP-сервис путём привязки к порту и прослушивает запросы, поступающих на этот порт.

## VIII. Параллелизм.

**Масштабируйте приложение с помощью процессов.**

В приложении двенадцати факторов процессы являются сущностями первого класса. С помощью этой модели разработчик может спроектировать приложение таким образом, что для обработки различной рабочей нагрузки необходимо назначить каждому типу работы свой тип процесса. Такая модель в полной мере демонстрирует свои преимущества, когда приходит время масштабирования. Отсутствие разделяемых данных и горизонтальное разделение процессов приложения означает, что добавление большего параллелизма является простой и надёжной операцией.

## IX. Утилизируемость.

**Максимизируйте надёжность с помощью быстрого запуска и корректного завершения работы.**

Процессы приложения двенадцати факторов являются утилизируемыми, это означает, что они могут быть запущены и остановлены в любой момент. Это способствует стабильному и гибкому масштабированию, быстрому развёртыванию изменений кода и конфигураций и надёжности рабочего развёртывания. Процессы также должны быть устойчивыми к внезапной смерти в случае отказа аппаратного обеспечения.

## X. Паритет разработки/работы приложения.

**Держите окружения разработки, промежуточного развёртывания (staging) и рабочего развёртывания (production) максимально похожими.**

Приложение двенадцати факторов спроектировано для непрерывного развёртывания благодаря минимизации различий между разработкой и работой приложения. Различия в используемых сторонних сервисах означают, что может возникнуть крошечная несовместимость, которая станет причиной того, что код, который работал и прошёл тесты при разработке и промежуточном развёртывании не работает в рабочем окружении. Такой тип ошибок создаёт помехи, которые нивелируют преимущества непрерывного развёртывания. Стоимость этих помех и последующего восстановления непрерывного развёртывания является чрезвычайно высокой, если рассматривать в совокупности за всё время существования приложения.

## XI. Журналирование.

**Рассматривайте журнал (logs) как поток событий.**

Приложение двенадцати факторов никогда не занимается маршрутизацией и хранением своего потока вывода. Приложение не должно записывать журнал в файл и управлять файлами журналов. Вместо этого каждый выполняющийся процесс записывает свой поток событий без буферизации в стандартный вывод. При промежуточном и рабочем развёртывании поток вывода каждого процесса будет захвачен средой выполнения, собран вместе со всеми другими потоками вывода приложения и перенаправлен к одному или нескольким конечным пунктам назначения для просмотра и долгосрочной архивации. Эти конечные пункты архивации не являются видимыми для приложения и настраиваемыми приложением, вместо этого они полностью управляются средой выполнения.

## XII. Задачи администрирования.

**Выполняйте задачи администрирования/управления с помощью разовых процессов.**

Разовые процессы администрирования следует запускать в среде идентичной регулярным длительным процессам приложения. Они запускаются на уровне релиза, используя те же кодовую базу и конфигурацию, как и любой другой процесс, выполняющий этот релиз. Код администрирования должен поставляться вместе с кодом приложения, чтобы избежать проблем синхронизации.
